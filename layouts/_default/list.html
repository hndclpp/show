{{ define "main" }}
<div class="post-container">
  <!-- 骨架屏容器 -->
  <div class="skeleton-container">
    {{ range (seq 3) }}
      {{ partial "skeleton-post.html" . }}
    {{ end }}
  </div>

  <!-- 实际内容容器 -->
  <div class="posts-container" style="display: none;">
    {{ range .Paginator.Pages }}  <!-- 使用 .Paginator.Pages 来分页 -->
      <div class="post">
        <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
        <!-- 日期、位置和标签合并成一个容器 -->
        <div class="meta-info">
          <!-- 日期 -->
          <span class="meta-item meta-weather">
            <a href="/timeline" class="meta-link">{{ .Date.Format "2006-01-02" }}</a>
          </span>

          <!-- 位置 -->
          {{ if .Params.location }}
            <span class="meta-item meta-location">
              {{ .Params.location }}
            </span>
          {{ end }}

          <!-- 标签 -->
          {{ if .Params.tags }}
            <span class="meta-item meta-tags">
              {{ range .Params.tags }}
                <a href="{{ "/tags/" | relLangURL }}{{ . | urlize }}/" class="tag">{{ . }}</a>
              {{ end }}
            </span>
          {{ end }}
        </div>   
        <!-- 摘要内容 -->
        <p class="summary">{{ .Summary }}</p>
      </div>
    {{ end }}

    <!-- 分页导航 -->
    {{ if or .Paginator.HasPrev .Paginator.HasNext }}
    <div class="pagination">
      {{ if .Paginator.HasPrev }}
        <a href="{{ .Paginator.Prev.URL }}" class="prev">
          上一页
        </a>
      {{ end }}

      <span class="page-number">{{ .Paginator.PageNumber }} / {{ .Paginator.TotalPages }}</span>

      {{ if .Paginator.HasNext }}
        <a href="{{ .Paginator.Next.URL }}" class="next">
          下一页
        </a>
      {{ end }}
    </div>
    {{ end }}
  </div>
</div>

<script>
// 等待所有资源加载完成
document.addEventListener('DOMContentLoaded', function() {
    // 给一个短暂的延迟以确保平滑过渡
    setTimeout(function() {
        const skeletonContainer = document.querySelector('.skeleton-container');
        const postsContainer = document.querySelector('.posts-container');
        
        if (skeletonContainer && postsContainer) {
            skeletonContainer.style.display = 'none';
            postsContainer.style.display = 'block';
        }
    }, 300); // 300ms 延迟
});
</script>
{{ end }}
